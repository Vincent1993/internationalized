# æ•°å­—æ ¼å¼åŒ–åŒ…æ¦‚è§ˆ

`@internationalized/number-format` åŸºäº `Intl.NumberFormat` æ„å»ºï¼Œå¯åœ¨ Reactã€Node.js ä»¥åŠè„šæœ¬ç¯å¢ƒä¸­ç»Ÿä¸€å¤ç”¨ç»„ä»¶ã€Hook ä¸å‡½æ•°å¼ APIã€‚

## æ¨¡å—åœ°å›¾

| æ¨¡å— | ç›®å½• | è¯´æ˜ |
|------|------|------|
| Core | `packages/number-format/src/core` | æ ¸å¿ƒæ ¼å¼åŒ–ä¸è§£æé€»è¾‘ã€ä¸Šä¸‹æ–‡ä¸å·¥å…·å‡½æ•° |
| Plugins | `packages/number-format/src/plugins` | æ’ä»¶æ³¨å†Œä¸­å¿ƒåŠå†…ç½®æ’ä»¶ï¼ˆåƒåˆ†æ¯”ã€å¼‚å¸¸å…œåº•ã€æ ¡éªŒã€å›ºå®š/åŠ¨æ€å°æ•°ä½ç­‰ï¼‰ |
| Components | `packages/number-format/src/components` | React ç»„ä»¶å°è£…ï¼Œå« `<NumberFormat>`ã€`<AutoMetricNumber>` ç­‰ |
| Hooks | `packages/number-format/src/hooks` | `useFormat`ã€`useParse`ã€`useAutoFormat` ç­‰ React Hook |
| FP APIs | `packages/number-format/src/fp` | å‡½æ•°å¼è°ƒç”¨å…¥å£ä¸ç¼“å­˜æœºåˆ¶ |
| Tests | `packages/number-format/tests` | è¦†ç›–æ ¸å¿ƒé€»è¾‘ã€æ’ä»¶ã€ç»„ä»¶ä¸ç±»å‹çš„æµ‹è¯•å¥—ä»¶ |

> ğŸ’¡ **è¿ç§»æç¤º**ï¼šæ ¹å…¥å£ä¸å†å¯¼å‡º `Format` é—ç•™å¯¹è±¡ï¼Œå¦‚éœ€ä¿æŒæ—§ç‰ˆ APIï¼Œè¯·ä» `@internationalized/number-format/legacy` æ˜¾å¼å¯¼å…¥ã€‚

## ç›®å½•ç»“æ„é€Ÿè§ˆ

```text
packages/number-format/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/           # æ ¸å¿ƒèƒ½åŠ›
â”‚   â”œâ”€â”€ plugins/        # æ’ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ components/     # React ç»„ä»¶
â”‚   â”œâ”€â”€ hooks/          # React Hooks
â”‚   â”œâ”€â”€ fp/             # å‡½æ•°å¼ API
â”‚   â””â”€â”€ index.ts        # ç»Ÿä¸€å¯¼å‡ºå…¥å£
â”œâ”€â”€ tests/              # æµ‹è¯•ç”¨ä¾‹
â””â”€â”€ package.json        # åŒ…ä¿¡æ¯ä¸è„šæœ¬
```

## åŠŸèƒ½çŸ©é˜µ

### æ ¸å¿ƒæ ¼å¼åŒ–

| åŠŸèƒ½åˆ†ç±» | ç»„ä»¶/Hook | FP å‡½æ•° | æè¿° |
|---------|----------|---------|------|
| **åŸºç¡€æ ¼å¼åŒ–** | `<NumberFormat>` | `formatAsDecimal` | æ ‡å‡†æ•°å­—æ ¼å¼åŒ–ï¼Œæ”¯æŒåƒåˆ†ä½ä¸å°æ•°ä½æ§åˆ¶ |
| **è´§å¸æ ¼å¼** | `<NumberFormat style="currency">` | `formatAsCurrency` | å¤šå¸ç§æ ¼å¼åŒ–ï¼Œè‡ªåŠ¨æ·»åŠ è´§å¸ç¬¦å· |
| **ç™¾åˆ†æ¯”æ ¼å¼** | `<NumberFormat style="percent">` | `formatAsPercent` | ç™¾åˆ†æ¯”æ˜¾ç¤ºï¼Œè‡ªåŠ¨è½¬æ¢æ•°å€¼èŒƒå›´ |
| **åƒåˆ†æ¯”æ ¼å¼** | `<NumberFormat style="per-mille">` | `formatAsPerMille` | åƒåˆ†æ¯”æ˜¾ç¤ºï¼Œä½¿ç”¨ â€° ç¬¦å· |
| **ä¸‡åˆ†æ¯”æ ¼å¼** | `<NumberFormat style="per-myriad">` | `formatAsPerMyriad` | ä¸‡åˆ†æ¯”/åŸºç‚¹æ˜¾ç¤ºï¼Œä½¿ç”¨ â€± ç¬¦å· |
| **ç™¾åˆ†ç‚¹æ ¼å¼** | `<NumberFormat style="percentage-point">` | `formatAsPercentagePoint` | ç™¾åˆ†ç‚¹æ˜¾ç¤ºï¼Œä½¿ç”¨ pp åç¼€ |
| **ä¸­æ–‡å¤§å†™æ•°å­—** | `<NumberFormat style="cn-upper">` | `formatAsChineseUppercase` | å°†æ•°å­—è½¬æ¢ä¸ºä¸­æ–‡å¤§å†™ |
| **ç´§å‡‘æ ¼å¼** | `<NumberFormat notation="compact">` | `formatAsCompact` | å¤§æ•°å€¼ç´§å‡‘æ˜¾ç¤ºï¼ˆå¦‚ 1.2Mï¼‰ |
| **ç§‘å­¦è®°æ•°æ³•** | `<NumberFormat notation="scientific">` | `formatAsScientific` | ç§‘å­¦è®°æ•°æ³•æ ¼å¼ï¼ˆå¦‚ 1.23E3ï¼‰ |
| **æ•´æ•°æ ¼å¼** | - | `formatAsInteger` | å¼ºåˆ¶æ•´æ•°æ˜¾ç¤ºå¹¶è‡ªåŠ¨å››èˆäº”å…¥ |

### è§£æèƒ½åŠ›

| åŠŸèƒ½åˆ†ç±» | Hook | FP å‡½æ•° | æè¿° |
|---------|------|---------|------|
| **åŸºç¡€è§£æ** | `useParse` | `parseDecimal` | å°†æ ¼å¼åŒ–å­—ç¬¦ä¸²è§£æå›æ•°å­— |
| **è´§å¸è§£æ** | `useParse` | `parseCurrency` | è§£æè´§å¸æ ¼å¼å­—ç¬¦ä¸² |
| **ç™¾åˆ†æ¯”è§£æ** | `useParse` | `parsePercent` | è§£æç™¾åˆ†æ¯”æ ¼å¼å­—ç¬¦ä¸² |
| **åƒåˆ†æ¯”è§£æ** | `useParse` | `parsePerMille` | è§£æåƒåˆ†æ¯”æ ¼å¼å­—ç¬¦ä¸² |
| **ä¸‡åˆ†æ¯”è§£æ** | `useParse` | `parsePerMyriad` | è§£æä¸‡åˆ†æ¯”/åŸºç‚¹å­—ç¬¦ä¸² |
| **ç™¾åˆ†ç‚¹è§£æ** | `useParse` | `parsePercentagePoint` | è§£æç™¾åˆ†ç‚¹ (pp) å­—ç¬¦ä¸² |
| **ä¸­æ–‡å¤§å†™è§£æ** | `useParse` | `parseChineseUppercase` | è§£æä¸­æ–‡å¤§å†™æ•°å­—å­—ç¬¦ä¸² |
| **æ™ºèƒ½è§£æ** | `useAutoParse` | `parseAuto` | è‡ªåŠ¨æ£€æµ‹æ ¼å¼å¹¶è§£æ |

### é«˜çº§ç‰¹æ€§

| åŠŸèƒ½åˆ†ç±» | ç»„ä»¶/Hook | é…ç½®æ–¹å¼ | æè¿° |
|---------|----------|----------|------|
| **å…¨å±€é…ç½®** | `<NumberFormatProvider>` | Provider | åº”ç”¨çº§é»˜è®¤é…ç½®ç®¡ç† |
| **æ™ºèƒ½è§„åˆ™** | `<AutoMetricNumber>` | `rules` å±æ€§ | åŸºäºåç§°/æ­£åˆ™è‡ªåŠ¨åŒ¹é…æ ¼å¼ |
| **å¼‚å¸¸å…œåº•** | å†…ç½®æ’ä»¶ | `registerPlugin` | å¤„ç† nullã€NaNã€Infinity ç­‰ |
| **å›ºå®šå°æ•°ä½** | `extend_fixDecimals` | æ‰©å±•é€‰é¡¹ | å¼ºåˆ¶è®¾ç½®å°æ•°ä½æ•° |
| **åŠ¨æ€å°æ•°ä½** | `extend_dynamicDecimals` | æ‰©å±•é€‰é¡¹ | è‡ªåŠ¨æ‰©å±•å°æ•°ä½å¹¶æ”¯æŒç§‘å­¦è®¡æ•°æ³•å›é€€ |
| **æ€§èƒ½ç¼“å­˜** | è‡ªåŠ¨ | `clearCache` | æ ¼å¼åŒ–å™¨ä¸è§£æå™¨è‡ªåŠ¨ç¼“å­˜ |
| **FP å…¨å±€é…ç½®** | - | `config()` | å‡½æ•°å¼é£æ ¼çš„å…¨å±€é…ç½® |
| **å¤šæ€ç»„ä»¶** | `as` å±æ€§ | HTML å…ƒç´  | æ¸²æŸ“ä¸ºä¸åŒæ ‡ç­¾ |
| **å‡½æ•°å¼æ¸²æŸ“** | `children` å‡½æ•° | Render Props | è‡ªå®šä¹‰æ¸²æŸ“é€»è¾‘ |

### ç±»å‹ä¸€è§ˆ

| ç±»å‹ | æè¿° | ç¤ºä¾‹ |
|------|------|------|
| `UseNumberFormatResult` | æ ¼å¼åŒ–ç»“æœ | `{ formattedValue, parts, sign, isNaN }` |
| `NumberFormatTemplate` | æ¨¡æ¿å­—ç¬¦ä¸²ç±»å‹ | `'currency|$.2f'` |
| `NumberFormatPlugin` | æ’ä»¶å®šä¹‰ | `{ name, stages, resolve }` |

## æ¨¡æ¿å­—ç¬¦ä¸²

`formatWithTemplate` æ”¯æŒç›´æ¥å¤ç”¨ `d3-format` é£æ ¼çš„æ¨¡æ¿ä½“éªŒï¼Œå¹¶è‡ªåŠ¨æ˜ å°„åˆ°å†…éƒ¨çš„ `Intl` é…ç½®ï¼š

```ts
import { formatWithTemplate } from '@internationalized/number-format/fp';

formatWithTemplate('currency|$.2f', 1234.56); // => "ï¿¥1,234.56"
formatWithTemplate('per-mille|.1%', 0.258); // => "258.0â€°"
formatWithTemplate('cn-upper', 1024); // => "å£¹ä»Ÿé›¶è´°æ‹¾è‚†"
```

> ğŸ“š æ›´å¤šæ‰©å±•ç¤ºä¾‹ä¸æ’ä»¶åˆ—è¡¨å¯å‚é˜…[æ¨¡æ¿å­—ç¬¦ä¸²](./templates.mdx)ä¸[æ’ä»¶ç³»ç»Ÿ](/reference/plugins)ã€‚

